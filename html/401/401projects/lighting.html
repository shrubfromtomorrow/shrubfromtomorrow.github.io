<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" href="../../../Images/Red.png" />
    <!--
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    -->
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,900;1,900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../../../css/401/401projects/lighting.css" />
    <script type="text/javascript" src="https://www.maths.nottingham.ac.uk/plp/pmadw/LaTeXMathML.js"></script>
    <title>Portfolio</title>
  </head>
  <body>
    <div class="load"></div>
    <section class="firstPage">
      <div class="containerFirstPage">
        <div id="nav">
          <a href="../../301/301home.html" id="junior">Junior</a>
          <a href="../../about.html" id="about">About</a>
          <a href="../../index.html" id="home">Home</a>
        </div>
        <div class="menubtn">
          <div class="menubtnburger"></div>
        </div>
        <div class="dropdown">
          <div class="dropdown-content">
            <ul class="dropdownLinks">
              <li id="homeLinkList">
                <a id="homeLink" href="../../index.html">Home</a>
              </li>
              <li id="juniorLinkList">
                <a id="juniorLink" href="#">Junior</a>
                <div id="horizPlusjun"></div>
                <div id="vertPlusjun"></div>
              </li>
              <ul class="juniorCollapsible">
                <li>
                  <a id="juniorHome" href="../../301/301home.html">Home</a>
                </li>
                <li>
                  <a id="juniorInternships" href="../../301/301internships.html"
                    >Internships</a
                  >
                </li>
                <li>
                  <a id="juniorLevelupreqs" href="../../301/301levelupreqs.html"
                    >LevelUp</a
                  >
                </li>
                <li>
                  <a id="juniorWriting" href="../../301/301writing.html"
                    >Writing</a
                  >
                </li>
                <li>
                  <a
                    id="juniorExhibitions"
                    href="../../301/301exhibitions/301exhibitionshome.html"
                    >Exhibitions</a
                  >
                </li>
                <li>
                  <a
                    id="juniorProjects"
                    href="../../301/301projects/301projectshome.html"
                    >Projects</a
                  >
                </li>
              </ul>
              <li id="seniorLinkList">
                <a id="seniorLink" href="#">Senior</a>
                <div id="horizPlussen"></div>
                <div id="vertPlussen"></div>
              </li>
              <ul class="seniorCollapsible">
                <li>
                  <a id="seniorHome" href="../401/401home.html">Home</a>
                </li>
                <li>
                  <a id="seniorInternships" href="../401/401internships.html"
                    >Internships</a
                  >
                </li>
                <li>
                  <a id="seniorLevelupreqs" href="../401/401levelupreqs.html"
                    >LevelUp</a
                  >
                </li>
                <li>
                  <a id="seniorWriting" href="../401/401writing.html"
                    >Writing</a
                  >
                </li>
                <li>
                  <a
                    id="seniorExhibitions"
                    href="../401/401exhibitions/401exhibitionshome.html"
                    >Exhibitions</a
                  >
                </li>
                <li>
                  <a
                    id="seniorProjects"
                    class="active"
                    href="../401/401projects/401projectshome.html"
                    >Projects</a
                  >
                </li>
              </ul>
            </ul>
          </div>
        </div>
        <p id="title">Lighting in 2D</p>
        <div class="typingBlurb">
          <div id="blurb">
            This is the page for my 2D lighting project and its expansions
          </div>
        </div>
        <div id="highlightsPrompt">
          (Scroll for the highlights)
          <div id="scrollCaret">˅</div>
        </div>
      </div>
    </section>
    <section class="secondPage">
      <div class="containerSecondPage">
        <header>
          <div class="custom-shape-divider-top-1663694557">
            <svg
              data-name="Layer 1"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 1200 120"
              preserveAspectRatio="none"
            >
              <path
                d="M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z"
                class="shape-fill"
              ></path>
            </svg>
          </div>
          <div class="subTitleCont">
            <div>In the beginning</div>
          </div>
          <div class="inTheBeginning">
            <div class="textCont1">
              <div id="paraTitle1">I Found a Video</div>
              <div id="mainBody1">
                Around December of 2021, I found a video about controlling LEDs
                in 3D space for a Christmas tree. It was absolutely fascinating
                and I knew immediately that I wanted to do it myself. There was
                one small issue though, the video was not technical in the
                slightest. It was heavily based around what the general process
                was but it was not a guide for how to set up the LEDs, how
                program them, or really HOW to do anything. For those
                interested, the link to the video is
                <a
                  href="https://www.youtube.com/watch?v=TvlpIojusBE&ab_channel=Stand-upMaths"
                  target="_blank"
                  rel="noreferrer noopener"
                  >here.</a
                ><br /><br />
                Being a programming novice who was painfully aware of how new I
                was to the field, I left the project for better days.
              </div>
            </div>
            <div class="textCont2">
              <div id="paraTitle2">The Better Days</div>
              <div id="mainBody2">
                One day in July of 2022, the Google algorithm gods looked down
                upon me and said "now's as good a time as any" and a video popped
                into my YouTube feed. It was pretty unassuming, just a guide on
                how to wire some WS2811 LEDs. I watched the video and came to
                the realization that, I knew how to start!<br /><br />
                Now of course, I did know a good way to start the project, as it
                semi-prominently featured in the video I watched initially
                regarding Christmas trees, but more importantly, I knew how to
                write the code.<br /><br />
                And so my journey began.
              </div>
            </div>
          </div>
        </header>
        <main>
          <div class="theCode">
            <div class="theCodeHeaderCont">
              <div id="theCodeHeader">The Setup</div>
            </div>
            <div class="lightsImCont">
              <img id="lights" src='../../../Images/humbleBeginnings.jpg'></img>
            </div>
            <div class="firstDescCont">
              <div id="firstDesc">
                This is where the images start but there was an intense electrical debugging session that occured before I came close to this point, so that is what I will walk you through.<br/> <br/>
                There had been some lights and a Raspberry Pi 3b hanging around my house for a while so those were the first things I got, following the video I was recommended, I tried to wire the LEDs up.
                The tutorial, however useful, was not helpful for my set of lights. I got the basic prinicple of how to get the adapters on but there was a lot of omitted information about what pins to use on the 
                Raspberry Pi, or which end was negative, or which end took in data and which end outputted data. It took a bit of work, but I got the idea of how to match what pin on the Pi to to what area on the lights.
                I then came to the realization that the pins I needed were not magically in a row and I would need some jumper cables to carry the current between the lights and the Pi.<br/><br/>
                Fast forward 2 days and I now have the Pi wired correctly, or so I thought. I had confused the notation GPIO 18, thinking it meant PHYSICAL pin 18, it did not.
                After getting the wiring correct (I was able to tell by the lights flashing once when I plugged them in).<br/> I wrote some code.
              </div>
            </div>
            <div class="firstDescpt2Cont">
              <div id="firstDescpt2">I don't have the exact code I wrote to do what it being done in the image above, but after poking around to figure out how the Neopixel library worked, I wrote some very simple stuff. Next to this is the first code I wrote that I have on record. <br/><br/>
                This is relatively simple compared to what you might have to endure later, and the basic idea is the I am testing the refresh rate of the lights. From this is was able to understand that 50 lights can refresh at 189 hertz. That is faster than most gaming monitors.<br/><br/>
                I also learned that the main thing that slows the lights updating was the .show() function (forshadowing). There is also some speed loss when using random numbere generation like I did here, but it is only a couple of seconds and since all my later tests are on the same scale, it can be disregarded.
              </div>
            </div>
            <div class="firstCodeCont">
              <img src="../../../Images/code1.png">
            </div>
            <div class="procedureNote1Cont">
              <div id="procedureNote1">At this point it is important to note how the code is being executed. All of the code I had written was executing on the Raspberry Pi. This is because the only way to control the lights is through the PWM pins on the Pi.
                Because all the code is being executed on the Pi, all of the calculations necessary to run the program are also being done on the Pi, and the Pi is significantly slower than my, or anybody's, laptop or computer. This becomes a problem later.
                <br/><br/>
                Also included in my verion control is some prototypical code for capturing images of the lights, this code is iterated on frequently and is extremely important as the project progresses.
                <br/><br/>
                Another piece of ineffiency to mention is the fact that all the lights that I wish to turn on, are being sent, through SSH, as arguments on the command line. Think for a second, if I had 300 lights, thats some 1000 characters required to turn the lights on. This would be remedied quickly.
              </div>
            </div>
            <div class="code2DescCont">
              <div id="code2Desc">Here is a bit of code I wrote to create a "center out" pattern. Using the center coordinate, I find every light's distance from the center and I sort a final list by that distance. Iterating through
                each light in the list and showing it is how the pattern is created.
                <br/><br/>
                This is the foundation for the Closest function, a function that is used in almost every pattern i have created and if there was a single spot that I would target for computation time improvements, this function would be it.
              </div>
            </div>
            <div class="codeExample2Cont">
              <img id="codeExample2" src="../../../Images/code2.png"></img>
            </div>
            <div class="expansionsHeaderCont">
              <div id="expansionsHeader">Expansions</div>
            </div>
            <div class="rotationTestDescCont">
              <div id="rotationTestDesc">After a couple of small optimizations, like including the light coordinates
                  as a supplemental text file and being able to execute a certain program from a centralized exec file,
                  I moved on to tackle rotation.
                <br/><br/>
                The goal here was to create some really nice mathematical patterns using rotation. Rotation is a little 
                tough, or at least they is when you don't know what you are doing. It just so happens that in the process of finding an effective method to represent
                rotation, I derived the 2 dimensional rotation matrix. That looks something like this:
              </div>
              <a href="https://latex.codecogs.com/" target="_blank" rel="noreferrer noopener"><img src="https://latex.codecogs.com/svg.image?\inline&space;\LARGE&space;{\color{White}\begin{bmatrix}x\\y\end{bmatrix}\begin{bmatrix}\cos{\theta}&space;&&space;&space;-\sin{\theta}\\\sin{\theta}&space;&&space;&space;\cos{\theta}\\\end{bmatrix}&space;=&space;\begin{bmatrix}x\prime\\y\prime\end{bmatrix}&space;"></a>
              <div>Where X and Y are input coordinates and X' and Y' are output coordinates.</div>
            </div>
            <div class="rotationTestResult">
              <div id="rotationTestResultDesc">Below is the output of the simple test I created to check if my math was correct (I did not know whether my math was correct or not because I had not thought to Google "rotation matrix").</div>
              <img src="../../../Images/rotationTestResult.png">
              <div id="rotationTestResultDesc2">And voilà! It worked! This was using an 18 degree rotation. This will be useful later.</div>
            </div>
            <div class="recap1Cont">
              <div id="recap1">So, at this point I had 100 lights set up in a horribly precarious situation, I had a method for mapping and describing the geometric relation between the lights, 
                and I had some cool patterns. Really all I did in the following weeks was add more lights and create new patterns. Following will be images and videos related to the light setup and the patterns I have created. Please be advised that almost all of the videos so far were taken with my laptop camera that gets terribly overexposed and is only 1280x720. The effect can be beneficial for seeing the macro of the light patterns.</div>
            </div>
            <div class="light100Setup">
              <img id="light100SetupIm" src="../../../Images/100lightSetup.jpg">
            </div>
            <div class="centerOut100">
              <video controls muted><source src="../../../Images/adjustedCenter100.webm" type="video/webm"></video>
            </div>
            <div class="fireworks200">
              <video controls muted><source src="../../../Images/fireworks200.webm" type="video/webm"></video>
            </div>
            <div class="centerOutRotate300">
              <video controls muted><source src="../../../Images/centerOutRotate300.webm" type="video/webm"></video>
            </div>
            <div class="animatedSpiral300Better">
              <video controls muted><source src="../../../Images/animatedSpiral300better.webm" type="video/webm"></video>
            </div>
            <div class="montageIntermission1Cont">
              <div id="montageIntermission1">And here we will take a pause. It is worth noting that, as of now, I have 30 recordings of various quality, I only wished to put the highlights in though. 
                I wanted to stop here to talk about two things, the magic of HSV, and the hardships of rotation.
                <br/><br/>
                I'll start with the big issue I had with rotation.
              </div>
            </div>
            <div class="rotationIssueCont">
              <div id="rotationIssue">One piece of code I had written involved finding what section of a circle a point lay in. In order to find that, with the x and y coordinates I had, I needed to use arctan. <br/><br/>Using the ratio of opposite over adjacent, I would be able to find the radian measure of 
                a point about my origin. This works because where tangent takes in an angle value and will return a ratio between two lengths (though what the lengths are is not explicit), the inverse function of tangent (arctangent) takes in a ratio of side lengths and returns an angle measure.
                The range of these return values is between π/2 and -π/2 and so using some basic if statements I was able to determine which quadrant of the circle the point lay in and I would add π/2 if it was in the second or third. Arctan is shown below.
                <br/><br/>
                <img src="https://latex.codecogs.com/svg.image?\color{white}r&space;=&space;\tan^{-1}(\frac{y}{x})">
                <br/><br/>
                The issue with this is that the ratio of opposite over adjacent could return undefined. In the situation where the adjacent side, or the x value, is 0, you would have an undefined output. And it just so happens that in my real lighting setup, with my camera of 921,600 pixels, I had a light sitting EXACTLY on the y axis (an x value of 0). 
                This was extremely difficult to debug as the error only occured on the 8th rotation (144 degrees) and it was on light 270. This is truly fascinating as the likelihood of a light being on the y-axis at any rotation is 720/921,600 or 0.078%. Not to mention that my decimal precision was set to 8, so the value of the adjacent side was less than 0.00000000.
              </div>
            </div>
          </div>
        </main>
      </div>
    </section>
    <script src="../../../javascript/lighting.js"></script>
  </body>
</html>

